<!DOCTYPE html>
<html>
<head>
    <title>Test Logs</title>
    <style>
        .btn { padding: 5px 10px; margin: 5px; border: 1px solid #ccc; background: #f8f9fa; cursor: pointer; }
        .btn-outline-danger { border-color: #dc3545; color: #dc3545; }
        .btn-outline-secondary { border-color: #6c757d; color: #6c757d; }
    </style>
</head>
<body>
    <h1>Test de Logs para Botones</h1>
    
    <table id="usersTable">
        <tbody>
            <tr>
                <td>Usuario Test</td>
                <td>test@example.com</td>
                <td>
                    <button type="button" class="btn btn-outline-secondary btn-sm toggle-status-btn" 
                            data-user-id="123"
                            data-current-status="HABILITADO"
                            title="Desactivar">
                        Toggle
                    </button>
                    <button type="button" class="btn btn-outline-danger btn-sm delete-user-btn" 
                            data-user-id="123"
                            data-user-name="Usuario Test"
                            title="Eliminar">
                        Delete
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <script>
        const baseUrl = '/devportal/po/testuser/platform-user-management';
        
        // Funciones copiadas del archivo original
        function showDeleteConfirmation(userId, userName) {
            console.log('=== SHOW DELETE CONFIRMATION INICIADO ===');
            console.log('üìã Par√°metros recibidos:', { userId, userName, userIdType: typeof userId });
            
            if (!userId) {
                console.error('‚ùå ERROR: userId est√° vac√≠o o undefined en showDeleteConfirmation');
                alert('Error: No se puede eliminar - ID de usuario no v√°lido');
                return;
            }
            
            const confirmMessage = `¬øEst√°s seguro de que quieres eliminar al usuario "${userName}"? Esta acci√≥n no se puede deshacer.`;
            console.log('üí¨ Mensaje de confirmaci√≥n:', confirmMessage);
            
            if (confirm(confirmMessage)) {
                console.log('‚úÖ Usuario confirm√≥ en showDeleteConfirmation, llamando deleteUser...');
                deleteUser(userId);
            } else {
                console.log('‚ùå Usuario cancel√≥ la eliminaci√≥n');
            }
        }
        
        function deleteUser(userId) {
            console.log('=== DELETE USER INICIADO ===');
            console.log('üìã Par√°metros recibidos:', { userId, type: typeof userId });
            alert('DELETE USER CALLED con userId: ' + userId);
        }
        
        function toggleUserStatus(userId, currentStatus) {
            console.log('=== TOGGLE USER STATUS INICIADO ===');
            console.log('üìã Par√°metros recibidos:', { userId, currentStatus, type: typeof userId });
            alert('TOGGLE USER STATUS CALLED con userId: ' + userId + ', status: ' + currentStatus);
        }

        function setupButtonEventListeners() {
            console.log('=== setupButtonEventListeners inicializado ===');
            
            document.addEventListener('click', function(e) {
                console.log('üñ±Ô∏è Click detectado en:', e.target);
                console.log('üñ±Ô∏è Elemento clickeado:', e.target.tagName, e.target.className);
                
                if (e.target.closest('.toggle-status-btn')) {
                    console.log('‚úÖ Toggle button clicked detectado');
                    const btn = e.target.closest('.toggle-status-btn');
                    const userId = btn.getAttribute('data-user-id');
                    const currentStatus = btn.getAttribute('data-current-status');
                    console.log('Toggle button data:', { userId, currentStatus });
                    toggleUserStatus(userId, currentStatus);
                    return;
                }
                
                const deleteBtn = e.target.closest('.delete-user-btn');
                if (deleteBtn) {
                    console.log('üóëÔ∏è Delete button clicked detectado');
                    console.log('üóëÔ∏è Delete button element:', deleteBtn);
                    const userId = deleteBtn.getAttribute('data-user-id');
                    const userName = deleteBtn.getAttribute('data-user-name') || 'Usuario';
                    console.log('Delete button data:', { userId, userName });
                    showDeleteConfirmation(userId, userName);
                    return;
                }
                
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    const button = e.target.tagName === 'BUTTON' ? e.target : e.target.closest('button');
                    console.log('üî¥ Click en bot√≥n no manejado:', {
                        element: button,
                        classes: button.className,
                        innerHTML: button.innerHTML,
                        attributes: Array.from(button.attributes).map(attr => `${attr.name}="${attr.value}"`)
                    });
                }
            });
            
            console.log('=== Event listeners configurados ===');
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ === P√ÅGINA CARGADA - INICIALIZANDO SISTEMA ===');
            console.log('üåê Base URL:', baseUrl);
            console.log('üìÑ Tabla de usuarios:', document.querySelector('#usersTable'));
            console.log('üîò Botones delete encontrados:', document.querySelectorAll('.delete-user-btn').length);
            console.log('üîò Botones toggle encontrados:', document.querySelectorAll('.toggle-status-btn').length);
            
            setupButtonEventListeners();
            
            console.log('‚úÖ Inicializaci√≥n completada');
        });
    </script>
</body>
</html>